{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Usuario</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="{% static 'login.css' %}">
    
</head>
<body>
    <div class="registro-container">
        <h2 class="registro-titulo">Crear Cuenta</h2>
        <form method="post" class="registro-formulario" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="registro-form-group">
                {{ form.nombre_completo.label_tag }}
                {{ form.nombre_completo }}
            </div>
    
            <div class="registro-form-group">
                {{ form.username.label_tag }}
                {{ form.username }}
            </div>
    
            <div class="registro-form-group">
                {{ form.password1.label_tag }}
                {{ form.password1 }}
            </div>
    
            <div class="registro-form-group">
                {{ form.departamento_fk.label_tag }}
                {{ form.departamento_fk }}
            </div>
    
            <div class="registro-form-group registro-inline">
                <div class="registro-inline-item">
                    {{ form.provincia_fk.label_tag }}
                    {{ form.provincia_fk }}
                </div>
                <div class="registro-inline-item">
                    {{ form.municipio_fk.label_tag }}
                    {{ form.municipio_fk }}
                </div>
            </div>
    
            <div class="registro-form-group">
                {{ form.direccion_1.label_tag }}
                {{ form.direccion_1 }}
            </div>
    
            <div class="registro-form-group">
                {{ form.direccion_2.label_tag }}
                {{ form.direccion_2 }}
            </div>
    
            <div class="registro-form-group">
                <label>MÃ©todo de pago QR</label>
                {{ form.qr_imagen.label_tag }} {{ form.qr_imagen }}
            </div>
    
            <div class="registro-form-group">
                {{ form.telefono.label_tag }}
                {{ form.telefono }}
            </div>
    
            <div class="registro-form-group">
                {{ form.email.label_tag }}
                {{ form.email }}
            </div>
    
            <div class="registro-form-group">
                <button type="submit" class="registro-btn-submit">Subir foto de perfil</button>
            </div>
    
            <button type="submit" class="registro-btn-submit">Crear una cuenta</button>
        </form>
    </div>

    <script type="text/javascript">
        $(document).ready(function() {
            // Cargar provincias cuando se selecciona un departamento
            $('#id_departamento_fk').change(function() {
                var url = "{% url 'ajax_cargar_provincias' %}";  // URL de la vista que carga provincias
                var departamentoId = $(this).val();
                $.ajax({
                    url: url,
                    data: {
                        'departamento_id': departamentoId
                    },
                    success: function(data) {
                        $("#id_provincia_fk").html('<option value="">Selecciona una provincia...</option>');
                        $.each(data, function(key, value) {
                            $("#id_provincia_fk").append('<option value="' + value.id + '">' + value.nombre + '</option>');
                        });
                    }
                });
            });

            // Cargar municipios cuando se selecciona una provincia
            $('#id_provincia_fk').change(function() {
                var url = "{% url 'ajax_cargar_municipios' %}";  // URL de la vista que carga municipios
                var provinciaId = $(this).val();
                $.ajax({
                    url: url,
                    data: {
                        'provincia_id': provinciaId
                    },
                    success: function(data) {
                        $("#id_municipio_fk").html('<option value="">Selecciona un municipio...</option>');
                        $.each(data, function(key, value) {
                            $("#id_municipio_fk").append('<option value="' + value.id + '">' + value.nombre + '</option>');
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>

